<html><head>
   <title>HI2CReceive</title>
   <meta name="generator"  content="HelpMaker.net" >
   <meta name="keywords"  content="HI2C Overview," ></head>
<body bgcolor="FFFCEA" >
<table width="100%"  border="0"  cellspacing="0"  cellpadding="2"  bgcolor="C0C0C0" >
  <tr>
    <td align="left" >
      <div align="left" ><font face="Arial"  size="4" ><span style="font-size:14pt" >HI2CReceive</span></font><font color="#010101" ></font></div>

    </td>
    <td align="right" >
      <font face="Arial"  size="2" >
        <a href="hi2cackpollstate.htm">Previous</a>&nbsp;&nbsp;<a href="hi2crestart.htm">Next</a>
      </font>
    </td>
  </tr></table>
<hr><div align="left" ><font face="Arial" ><span style="font-size:12pt" ><b>Syntax:&nbsp;&nbsp;&nbsp;&nbsp;</b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >HI2CReceive <i>data</i></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Arial"  color="#010101" ><span style="font-size:12pt" >HI2CReceive <i>data</i>, <i>ACK</i></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >HI2CReceive <i>data</i>, N<i>ACK</i></span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ></font><font face="Arial"  color="#010101" ><span style="font-size:12pt" ><b>Command Availability:</b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Only available for microcontrollers with the hardware I2C or TWI module.</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Arial" ><span style="font-size:12pt" ><b>Explanation:</b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >The HI2CReceive command will send <i>data</i> through the I2C connection. If <i>ack</i> is TRUE, or no value is given for <i>ack</i>, then I2CReceive will send an 
ack to the I2C bus.</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Arial"  color="#010101" ><span style="font-size:12pt" >If in master mode, I2CReceive will read the data immediately. If in slave 
mode, I2CReceive will wait for the master to send the data before 
reading.</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font color="#010101" ></font></div><div align="left" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" ><b>Note:</b></span></font><font color="#010101" ></font></div><div align="left" ><font face="Arial"  color="#010101" ><span style="font-size:12pt" ><b>&nbsp;&nbsp;&nbsp;&nbsp;</b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Arial"  color="#010101" ><span style="font-size:12pt" >This command is also available on microcomputers with a second 
hardware I2C port.</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New"  color="#010101" ><span style="font-size:11pt" ><b>HI2C2Receive </b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></font></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Arial" ><span style="font-size:12pt" ><b>Example 1:</b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >'This program reads an I2C register and sets an LED if it is over 
100.</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >'It will read from I2C device with an address of 83, register 1.</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:25mm; margin-right:0mm; text-indent:0mm; " ><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >' Change the processor</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >#chip 16F1937, 32</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >#config Osc = intOSC, MCLRE_ON, PLLEN_ON, VCAPEN_OFF</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></font></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >' Define I2C settings</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >#define HI2C_BAUD_RATE 400</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >#define HI2C_DATA PORTC.4</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >&nbsp; #define HI2C_CLOCK PORTC.3</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >'I2C pins need to be input for SSP module</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >Dir HI2C_DATA in</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >Dir HI2C_CLOCK in</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >'MASTER I2C Device</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New"  color="#010101" ><span style="font-size:10pt" >HI2CMode Master</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >'Misc settings</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >#define LED PORTB.0</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >'Main loop</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >Do</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;'Send start</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;HI2CStart</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;'Request value</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;HI2CSend 83</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;HI2CSend 1</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><br></div><font color="#010101" ><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;'Read value</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;<b>HI2CReceive ValueIn</b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" ><b>&nbsp;&nbsp;&nbsp;&nbsp;</b></span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;'Send stop</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;HI2CStop</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;'Turn on LED if received value &gt; 100</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;Set LED Off</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;If ValueIn &gt; 100 Then Set LED On</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;'Delay</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;Wait 20 ms</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font face="Courier New" ><span style="font-size:10pt" >Loop</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font color="#010101" ></font></div><div align="left" ><font face="Arial" ><span style="font-size:12pt" ><b>Example 2: </b></span></font><font face="Arial"  color="#010101" ><span style="font-size:12pt" >See the </span></font><a href="overview.htm"><font face="Arial"  color="#0000ff" ><span style="font-size:12pt" ><u>I2C Overview</u></span></font></a><font face="Arial"  color="#010101" ><span style="font-size:12pt" > for the Master mode device to control this 
Slave mode device. </span></font><font color="#010101" ></font></div><div align="left" ><font color="#010101" ></font></div><div align="left"  style="margin-left:25mm; margin-right:0mm; text-indent:0mm; " ><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >' I2CHardwareReceive_Slave.gcb - using a 16F88.</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >' This program receives commands from a GCB Master. This Slave has three 
LEDs attached.</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >; This Slave device responds to address 0x60 and may only be written to.</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >; Within it, there are three registers, 0,1 and 2 corresponding to the 
three LEDs. Writing a zero</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >; turns the respective LED off. Writing anything else turns it on.</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >#chip 16F88, 4</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#config INTRC_IO,MCLR_Off</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >#define I2C_MODE&nbsp;&nbsp;&nbsp; Slave&nbsp;&nbsp;&nbsp;&nbsp; ;this is a slave device now</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#define I2C_CLOCK&nbsp;&nbsp; portb.4&nbsp;&nbsp; ;SCL on pin 10</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#define I2C_DATA&nbsp;&nbsp;&nbsp; portb.1&nbsp;&nbsp; ;SDA on pin 7</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#define I2C_ADDRESS 0x60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;address of the slave device</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >#define I2C_BIT_DELAY 20 us</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#define I2C_CLOCK_DELAY 10 us</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#define I2C_END_DELAY 10 us</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >'Serial settings</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#define SerInPort PORTB.6</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#define SerOutPort PORTB.7</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >#define SendAHigh Set SerOutPort OFF</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#define SendALow Set SerOutPort On</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >'Set pin directions</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >Dir SerOutPort Out</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >Dir SerInPort In</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >'Set up serial connection</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >InitSer 1, r2400, 1 + WaitForStart, 8, 1, none, INVERT</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >wait 1 s</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >#define LED0&nbsp; porta.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;pin 1</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#define LED1&nbsp; porta.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;pin 2</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >#define LED2&nbsp; porta.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;pin 3</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >;----- Variables</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >dim addr, reg, value,location as byte</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >addr = 255</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >reg = 255</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >value = 255</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >location = 0</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >mempointer = 255</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >;----- Program</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >dir LED0 out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;0, 1 and 2 are outputs (LEDs)</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >dir LED1 out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;0, 1 and 2 are outputs (LEDs)</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >dir LED2 out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;0, 1 and 2 are outputs (LEDs)</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >set LED0 off</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >set LED1 off</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >set LED2 off</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >#define SerialControlPort portb.3</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >dir SerialControlPort in</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >'Set up interrupt to process I2C</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; dir I2C_CLOCK in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; required to input for MSSP module</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; dir I2C_DATA in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; required to input for MSSP module</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; SSPADD=I2C_ADDRESS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; Slave address</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; SSPSTAT=b'00000000'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; configuration</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; SSPCON=b'00110110'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; configuration</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; PIE1.SSPIE=1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; enable interrupt</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >repeat 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;flash LEDs</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; set LED0 on</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; set LED1 on</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; set LED2 on</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; wait 50 ms</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; set LED0 off</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; set LED1 off</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; set LED2 off</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp; wait&nbsp; 100 ms</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >end Repeat</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >oldvalue = 255&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; old value, set up value only</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >oldreg = 255&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; old value, set up value only</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >UpdateLEDS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; call method to set LEDs</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; set up interrupt</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >On Interrupt SSP1Ready call I2C_Interrupt</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >do forever</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; if reg &lt;&gt; oldreg then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; only process when the reg is a new value</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldreg = reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; retain old value</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show = 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; its time to show the LEDS!</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if&nbsp; value &lt;&gt; oldvalue then&nbsp;&nbsp;&nbsp; ; logic for tracking old values. 
You only want to update terminal once per change</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldvalue = value</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show = 1</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; UpdateLEDS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; Update date LEDs</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; update serial terminal</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; if show = 1&nbsp; and SerialControlPort = 1 then</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1, &quot;0x&quot;+hex(addr)</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerSend 1,9</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1, STR(reg)</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerSend 1,9</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerPrint 1, STR(value)</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerSend 1,10</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SerSend 1,13</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show = 0</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >loop</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >Sub I2C_Interrupt</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp; ' handle interrupt</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp; IF SSPIF=1 THEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; its a valid interrupt</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF SSPSTAT.D_A=0 THEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; its an address coming in!</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; addr=SSPBUF</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF addr=I2C_ADDRESS THEN&nbsp;&nbsp;&nbsp; ; its our address</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mempointer = 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; set the memory pointer. This 
code emulates an EEPROM!</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF addr = ( I2C_ADDRESS | 1 ) THEN&nbsp;&nbsp;&nbsp; ; its our write address</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CKP = 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; acknowledge command</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
; If the SDA line was 
low (ACK), the transmit data must be loaded into</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
; the SSPBUF register 
which also loads the SSPSR</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
; register. Then, pin 
RB4/SCK/SCL should be enabled</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
; by setting bit CKP.</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mempointer = 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; set a pointer to track 
incoming write reqests</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if I2C_DATA = 0 then</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SSPBUF = 0x22</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CKP = 1</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; readpointer = 0x55</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if&nbsp; SSPSTAT.P = 1 then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Stop bit has been detected 
- out of sequence</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' handle event</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF&nbsp; SSPSTAT.S = 1 THEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Start bit has been 
detected - out of sequence</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' handle event</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; END IF</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF SSPSTAT.R_W = 0 THEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Write operations requested</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SELECT CASE mempointer</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE 0</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reg = SSPBUF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' incoming value</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mempointer++&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' increment our counter</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE 1</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = SSPBUF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' incoming value</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mempointer++&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' increment our counter</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE ELSE</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dummy = SSPBUF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' incoming value</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; END SELECT</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ELSE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Read operations</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SSPBUF = readpointer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' incoming value</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; readpointer++&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' increment our counter</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; END IF</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; END IF</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CKP = 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' acknowledge command</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SSPOV = 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' acknowledge command</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp; END IF</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp; SSPIF=0</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >END SUB</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >sub UpdateLEDS</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp; select case reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;now turn proper LED on or off</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 0</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if value = 1 then</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set LED0 on</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set LED0 off</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 1</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if value = 1 then</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set LED1 on</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set LED1 off</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 2</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if value = 1 then</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set LED2 on</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set LED2 off</span></font><font color="#010101" ></font></div><div align="left" ><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >&nbsp;&nbsp;&nbsp; end select</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ></font><font face="Courier New" ><span style="font-size:10pt" >End Sub</span></font><font color="#010101" ></font></div><div align="left" ><br></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ><br></font></div><font color="#010101" ><div align="left" ></font><font face="Arial"  color="#010101" ><span style="font-size:12pt" >Supported in &lt;HI2C.H&gt;</span></font><font color="#010101" ></font></div><div align="left"  style="margin-left:13mm; margin-right:0mm; text-indent:0mm; " ><font color="#010101" ></font></div>

</html>
